def small_idx(r9, r10):
    # return ((( (tid ^ 1) * -1 ) + tid + tid) & 7)

    r14 = r9 ^ 1;
    
    # /*00c8*/ // IADD3 R0, -R0, R2, R9 
    r15 = r9 + r10
    r16 = r15 - r14
    r17 = r16 & 7
    return r17    
    # /*00e8*/ // LOP32I.AND R0, R0, 0x7 ;

out = [0x3c,0x3a,0x0f,0x5a,0x12,0x54,0x12,0x40,0x3a,0x3b,0x5a,0x0e,0x00,0x05,0x5e,0x26,0x33,0x0b,0x05,0x3b,0x5f,0x03,0x0a,0x05,0x32,0x22,0x2c,0x16,0x1d,0x24,0x3a,0x10,0x18,0x63,0x19,0x19,0x0e,0x5c,0x03,0x09,0x67,0x57,0x08,0x25,0x63,0x1a,0x19,0x26,0x64,0x12,0x07,0x34,0x34,0x24,0x3a,0x10,0x36,0x31,0x1a,0x50,0x51,0x08,0x12,0x51,0x21,0x08,0x1e,0x01,0x2a,0x18,0x38,0x1a,0x00,0x23,0x1c,0x19,0x10,0x23,0x34,0x04,0x27,0x38,0x04,0x31,0x13,0x34,0x00,0x0f,0x25,0x28,0x32,0x16,0x2c,0x67,0x27,0x1f,0x07,0x35,0x00,0x34,0x3f,0x16,0x16,0x05,0x2d,0x31,0x0e,0x19,0x20,0x0b,0x23,0x20,0x3b,0x16,0x06,0x05,0x34,0x19,0x16,0x17,0x27,0x3f,0x31,0x18,0x02,0x01,0x1e,0x04,0x31,0x00,0x0b,0x1c,0x27,0x3e,0x27,0x16,0x3a,0x21,0x0f,0x34,0x0b,0x39,0x1f,0x0d,0x22,0x18,0x04,0x0b,0x05,0x0a,0x18,0x00,0x21,0x19,0x08,0x1a,0x18,0x08,0x0b,0x11,0x1c,0x37,0x34,0x34,0x24,0x54,0x00,0x04,0x3c,0x0d,0x5a,0x33,0x6d,0x00,0x7f,0x31,0x35,0x46,0x0c,0x03,0x25,0x74,0x02,0x00,0x08,0x6f,0x31,0x50,0x2c,0x22,0x43,0x16,0x79,0x48,0x58,0x43,0x6b,0x4c,0x79,0x5e,0x48,0x7a,0x43,0x46,0x48,0x7a,0x46,0x48,0x6b,0x79,0x4c,0x43,0x46,0x46,0x1c,0x4c,0x6b,0x6b,0x7a,0x5e,0x17,0x33,0x79,0x5e,0x5e,0x79,0x46,0x46,0x7a,0x48,0x5e,0x4c,0x79,0x43,0x46,0x6b,0x79,0x43,0x6b,0x79,0x7a,0x5e,0x48,0x46,0x6b,0x6b,0x48,0x48,0x7a,0x7a,0x43,0x4c,0x4c,0x43,0x5e,0x4c]
template = b'snakeCTF'
perm_table = [15, 0, 0, 0, 21, 0, 0, 0, 2, 0, 0, 0, 18, 0, 0, 0, 6, 0, 0, 0, 27, 0, 0, 0, 7, 0, 0, 0, 17, 0, 0, 0, 13, 0, 0, 0, 24, 0, 0, 0, 26, 0, 0, 0, 4, 0, 0, 0, 29, 0, 0, 0, 16, 0, 0, 0, 20, 0, 0, 0, 5, 0, 0, 0, 22, 0, 0, 0, 31, 0, 0, 0, 11, 0, 0, 0, 10, 0, 0, 0, 12, 0, 0, 0, 28, 0, 0, 0, 3, 0, 0, 0, 19, 0, 0, 0, 14, 0, 0, 0, 30, 0, 0, 0, 8, 0, 0, 0, 25, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 23, 0, 0, 0, 9]
perm_table = [perm_table[i] for i in range(0, 128, 4)]

c = 0
key = [0]*8
for i in range(8):
    idx = perm_table.index(i)
    key[small_idx(0, i)] = template[i] ^ out[idx]

print(bytes(key))
